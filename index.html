<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Ultimate Snake</title>
<style>
  html,body{
    height:100%;
    margin:0;
    background:radial-gradient(1200px 800px at 50% 35%, #0b2a26, #071a18);
    overflow:hidden;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  }
  .splash{
    position:fixed; inset:0; display:grid; place-items:center; padding:18px;
    opacity:1; transform: translateZ(0);
    transition: opacity 420ms ease, filter 420ms ease;
  }
  .splash.fadeOut{ opacity:0; filter: blur(6px); pointer-events:none; }
  .poster{
    position:relative;
    width:min(820px, 92vw);
    aspect-ratio: 4 / 3;
    border-radius:24px;
    overflow:hidden;
    box-shadow:0 30px 90px rgba(0,0,0,.55);
  }
  .poster img{
    position:absolute; inset:0;
    width:100%; height:100%;
    object-fit:cover;
    transform-origin:50% 55%;
    animation:bob 4.8s ease-in-out infinite;
  }
  .glow{
    position:absolute; inset:-30%;
    background:radial-gradient(circle at 50% 45%, rgba(120,255,200,.25), transparent 55%);
    mix-blend-mode:screen;
    opacity:.45;
    animation:pulse 3.2s ease-in-out infinite;
    pointer-events:none;
  }
  .particles{ position:absolute; inset:0; pointer-events:none; }
  .p{ position:absolute; border-radius:999px; background:rgba(160,255,220,.18); animation:floatUp linear infinite; }

  /* Tongue (aligned to your image) */
  .tongue{
    position:absolute;
    left:65.6%;
    top:12.3%;
    width:62px; height:18px;
    transform:translate(-50%,-50%);
    transform-origin:0% 50%;
    pointer-events:none;
  }
  .tongue::before{
    content:""; position:absolute; left:0; top:50%;
    width:52px; height:10px;
    transform:translateY(-50%) scaleX(0);
    border-radius:999px;
    background:linear-gradient(90deg,#ff7aa8,#ff5a8c);
    box-shadow:0 0 18px rgba(255,120,170,.25);
    animation:tongue10s 10s ease-in-out infinite;
  }
  .tongue::after{
    content:""; position:absolute; left:44px; top:50%;
    width:14px; height:14px;
    transform:translateY(-50%) scale(0);
    background:#ff5a8c;
    clip-path:polygon(0 50%,100% 0,100% 100%);
    animation:tongueTip10s 10s ease-in-out infinite;
  }

  .hint{
    position:absolute; left:50%; bottom:14px; transform:translateX(-50%);
    padding:8px 12px; border-radius:999px;
    background:rgba(0,0,0,.35);
    border:1px solid rgba(255,255,255,.14);
    color:rgba(255,255,255,.86);
    font-weight:800; font-size:13px;
    user-select:none;
    backdrop-filter: blur(8px);
  }

  @keyframes bob{ 0%,100%{ transform:translateY(0) scale(1);} 50%{ transform:translateY(-4px) scale(1.002);} }
  @keyframes pulse{ 0%,100%{ opacity:.35;} 50%{ opacity:.55;} }
  @keyframes floatUp{
    from{ transform:translateY(46px); opacity:0; }
    10%{ opacity:.6; }
    to{ transform:translateY(-514px); opacity:0; }
  }
  @keyframes tongue10s{
    0%,94%{ transform:translateY(-50%) scaleX(0); opacity:0; }
    95%{ transform:translateY(-50%) scaleX(1.05); opacity:1; }
    97%{ transform:translateY(-50%) scaleX(1); opacity:1; }
    99%,100%{ transform:translateY(-50%) scaleX(0); opacity:0; }
  }
  @keyframes tongueTip10s{
    0%,94%{ transform:translateY(-50%) scale(0); opacity:0; }
    95%{ transform:translateY(-50%) scale(1.05); opacity:1; }
    97%{ transform:translateY(-50%) scale(1); opacity:1; }
    99%,100%{ transform:translateY(-50%) scale(0); opacity:0; }
  }

/* v1.0.3 splash transition layer */
#tapOverlay{
  position: fixed;
  inset: 0;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 10vh;
  pointer-events: auto;
  z-index: 9999;
  background: linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,0.25) 70%, rgba(0,0,0,0.45) 100%);
  transition: opacity 260ms ease, transform 260ms ease;
  opacity: 1;
}
#playBtn{
  appearance:none;
  -webkit-appearance:none;
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
  font-weight:700;
  letter-spacing:0.5px;
  font-size:18px;
  padding:12px 18px;
  border-radius:999px;
  background: rgba(0,0,0,0.55);
  color: rgba(255,255,255,0.92);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border: 1px solid rgba(255,255,255,0.18);
  cursor:pointer;
  user-select:none;
  -webkit-user-select:none;
  touch-action: manipulation;
}
#playBtn:active{ transform: translateY(7px); }
body.splashFadeOut #tapOverlay{opacity:0;transform:translateY(14px);pointer-events:none;}
body.splashFadeOut{transition:opacity 260ms ease;opacity:0;}

/* v1.1.0 music toggle (splash) */
#musicToggle{
  position:fixed;
  top: max(12px, env(safe-area-inset-top));
  left: max(12px, env(safe-area-inset-left));
  z-index: 10000;
  appearance:none;-webkit-appearance:none;
  border:1px solid rgba(255,255,255,0.18);
  background: rgba(0,0,0,0.45);
  color: rgba(255,255,255,0.92);
  border-radius: 999px;
  padding: 8px 12px;
  font: 700 14px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  letter-spacing: .2px;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  cursor: pointer;
  user-select:none;-webkit-user-select:none;
  touch-action: manipulation;
}
#musicToggle:active{ transform: translateY(1px); }

</style>
</head>
<body>
<button id="musicToggle" type="button" aria-label="Toggle music">Music: On</button>

  <div class="splash" id="splash" aria-label="Ultimate Snake splash screen">
    <div class="poster">
      <img src="ultimate-snake-splash.png" alt="Ultimate Snake" />
      <div class="glow"></div>
      <div class="particles" id="particles"></div>
      <div class="tongue" aria-hidden="true"></div>
      <div class="hint">Tap to Start</div>
    </div>
  </div>

<script>
  const GAME_URL = "game.html";

  const holder = document.getElementById("particles");
  const COUNT = 32;
  for (let i=0;i<COUNT;i++){
    const d=document.createElement("div");
    d.className="p";
    d.style.left = (Math.random()*100) + "%";
    d.style.top  = (70 + Math.random()*40) + "%";
    const size = (3 + Math.random()*6);
    d.style.width = d.style.height = size + "px";
    d.style.animationDuration = (6 + Math.random()*8) + "s";
    d.style.animationDelay = (-Math.random()*8) + "s";
    holder.appendChild(d);
  }

  const splash = document.getElementById("splash");
  let transitioning = false;

  function goToGame(){
    if (transitioning) return;
    transitioning = true;
    splash.classList.add("fadeOut");
    setTimeout(() => { window.location.href = GAME_URL; }, 460);
    setTimeout(() => { window.location.href = GAME_URL; }, 1200);
  }

  splash.addEventListener("pointerdown", goToGame, { passive:true });
  window.addEventListener("keydown", (e) => {
    if (e.key === "Enter" || e.key === " "){
      e.preventDefault();
      goToGame();
    }
  });
</script>

<!-- v1.0.3 splash transition layer -->
<div id="tapOverlay">
  <button id="playBtn" type="button">Tap to Start</button>
</div>
<script>
/* v1.1.0 splash transition + music toggle (index.html only) */
(function(){
  const TARGET='game.html';
  const MUSIC_URL="https://ia800304.us.archive.org/11/items/ClaireDeLune_201309/Claire%20de%20lune.mp3";
  const STORE_KEY='us_music_on';
  const START_FLAG='us_start_music';

  let started=false;
  let audio=null;

  function getMusicOn(){
    const v=localStorage.getItem(STORE_KEY);
    return v===null ? true : (v==='1');
  }
  function setMusicOn(on){ localStorage.setItem(STORE_KEY, on ? '1' : '0'); }

  function ensureAudio(){
    if(audio) return audio;
    audio = new Audio(MUSIC_URL);
    audio.loop = true;
    audio.preload = 'none';
    audio.volume = 0.22;
    return audio;
  }

  function updateToggle(){
    const btn=document.getElementById('musicToggle');
    if(btn) btn.textContent = 'Music: ' + (getMusicOn() ? 'On' : 'Off');
  }

  function fadeOutAndStop(ms){
    if(!audio) return;
    const startVol = audio.volume;
    const t0 = performance.now();
    function step(t){
      const p = Math.min(1, (t - t0) / ms);
      audio.volume = startVol * (1 - p);
      if(p < 1) requestAnimationFrame(step);
      else {
        try { audio.pause(); } catch(_e){}
        audio.volume = startVol;
      }
    }
    requestAnimationFrame(step);
  }

  function go(){
    if(started) return;
    started=true;

    try { sessionStorage.setItem(START_FLAG, '1'); } catch(_e){}

    if(getMusicOn()) {
      const a=ensureAudio();
      a.play().catch(function(){});
      fadeOutAndStop(500);
    }

    document.body.classList.add('splashFadeOut');
    setTimeout(()=>window.location.assign(TARGET), 280);
  }

  function bind(){
    const playBtn=document.getElementById('playBtn');
    if(playBtn){
      playBtn.addEventListener('touchend', function(e){ e.preventDefault(); go(); }, {passive:false, once:true});
      playBtn.addEventListener('click', function(){ go(); }, {once:true});
      playBtn.addEventListener('keydown', function(e){ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); go(); } });
    }

    const toggle=document.getElementById('musicToggle');
    if(toggle){
      updateToggle();
      const flip=function(e){ e.preventDefault(); setMusicOn(!getMusicOn()); updateToggle(); };
      toggle.addEventListener('click', flip);
      toggle.addEventListener('touchend', flip, {passive:false});
    }
  }

  if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', bind, {once:true});
  else bind();
})();
</script>

</body>
</html>
